<!DOCTYPE html>
<html lang="ko" xmlns:th="http://www.thymeleaf.org">
<meta charset="utf-8">

<style>			    			 	    	

		/* [html, body 영역 스타일 지정] */
		html, body{
			width : 100%;
			height : 100%;
			margin : 0;
			padding : 0;
			border : none;	
			overflow : auto;				
		}		
		
		/* [body 스크롤바 메인 스타일 지정] */
		body::-webkit-scrollbar {
			width: 10px;
			background-color: #c1c1c1;
		}
		/* body 스크롤바 thumb 스타일 지정 */
		body::-webkit-scrollbar-thumb {		
			background-color: #444444;
		}
		      				                          
    </style>

<script>
$(document).ready(function(){
$('#search_btn2').click(function(){
	$('#search_form2').attr({
		method:'get',
		action:'[[@{/search}]]'
	});
	$('#search_form2').submit();
});
paging();
});

function GetTarget(j){
	var cateid="[[${cate.cateid}]]";
}
	$.ajax({
		url:'facility/facilitypage',
		data:{
			'pageNo':j,
			'cateid':cateid
		},
		method:'GET',
		success: function(result){
			$('#div_trainer_row').empty();
			$('#div_trainer_row').append(result);
			
			currentPage = j;
			totalData = $('#input_hiddencnt').val();
			totalPages = Math.ceil(totalData / limitPerPage);
			pageGroup = Math.ceil(currentPage / pageSize);
			last = pageGroup * pageSize;
			veryLast = totalPages;
			
			calcPage();
		}
	});

var currentPage = 0;
var totalData = 0;
var limitPerPage = "[[${amount}]]";
var pageSize = 5;
var totalPages = 0;
var pageGroup = 0;
var last = 0;
var veryFirst = 1;
var veryLst = 0;
var first = 0;
var next = 0;
var prev = 0;

	function calcPage(){
		var pages = $('#pages');
		pages.empty();
		
		if(currentPage <= 0){
			currentPage = 1;
		}
		if(last > totalPages){
			last = totalPages;
		}
		
		first = last - (pageSize - 1);
		next = last + 1;
		prev = first - 1;
		
		if(totalPages < 1){
			first = last;
		}
		
		if(totalPages > 1){
			pages.append('<li><a onclick="GetTarget('+ veryFirst +')"><<</a></li>');
		}
		
		// prev 버튼
		if(first > 1){
			pages.append('<li><a onclick="GetTarget('+ first +')"><</a></li>');
		}
		
		// 페이지 숫자
		for (var j = first; j <= last; j++) {
			
			if(currentPage == j){
				pages.append('<li class="active"><a onclick="GetTarget(' + j + ');"' + '>' + j + '</a></li>');
			}else if(j > 0){
				pages.append('<li><a onclick="GetTarget('+ j +')">' + j + '</a></li>');
				};
			}
		
		// next 버튼
		if(next > pageSize && next <= totalPages){
			pages.append('<li><a onclick="GetTarget(' + next + ')">></a></li>');
		};
		
		if(totalPages > 1){
			pages.append('<li><a onclick="GetTarget('+ veryLast +')">>></a></li>');
		};
	}

	function paging(totalData, currentPage){
		
		totalData = $('#input_hiddencnt').val();
		currentPage = "[[${currentPage}]]";
		totalPages = Math.ceil(totalData / limitPerPage);
		pageGroup = Math.ceil(currentPage / pageSize); 
		last = pageGroup * pageSize;
		veryLast = totalPages;
		
		calcPage();
	}



</script>
 
  <body>


    <section class="hero-wrap hero-wrap-2 ftco-degree-bg js-fullheight" style="background-image: url('images/bg_1.jpg');" data-stellar-background-ratio="0.5">
      <div class="overlay"></div>
      <div class="container">
        <div class="row no-gutters slider-text js-fullheight align-items-center justify-content-center">
          <div class="col-md-9 ftco-animate pb-5 text-center">
          	<p class="breadcrumbs"><span class="mr-2"><a th:href="@{/index}">Home <i class="ion-ios-arrow-forward"></i></a></span> <span>Properties <i class="ion-ios-arrow-forward"></i></span></p>
            <h1 class="mb-3 bread">Choose <br>Your Desired Home</h1>
          </div>
        </div>
      </div>
     
    </section>
		<section class="ftco-section">
    	<div class="col-md-2 sidebar ftco-animate">
 		<div class="sidebar-box">
			<form id="search_form2" action="#" class="search-form">
              <div class="form-group">
                <span id="search_btn2" class="icon icon-search"></span>
                 <input name="txt" type="text" class="form-control" placeholder="Type a keyword and hit enter">
              </div>
            </form>
          </div>
          <div class="sidebar-box ftco-animate" >

            <div class="categories">
              <h3>Categories</h3>
              <li><a th:href="@{/facility(cateid=10)}">HEALTH</a></li>
              <li><a th:href="@{/facility(cateid=20)}">PILATES</a></li>
              <li><a th:href="@{/facility(cateid=30)}">CROSSFIT</a></li>

            </div>

          </div>
          </div>
		
    	<div class="container">
        <div class="row">
        	<div class="col-md-4" th:each="fl:${facilitylist}">
        		<div class="property-wrap ftco-animate">
         			<a th:href="@{/facilitydetail(facilityid=${fl.facilityid})}"class="img" th:style="'background-image: url('+@{fimages/}+${fl.facilityimg}+@{.jpg}+');'"></a> 

        			<div class="facility_name" th:text="${fl.facilityname}"> </div>
        			<div class="facility_number" th:text="${fl.facilitynumber}"> </div>
        		</div>
        	</div>
     
        </div>

    	</div>
		<div class="row mt-5">
					<div class="col text-center">
						<div class="block-27">
							<ul id="pages">
							</ul>
						</div>
					</div>
				</div>
    </section>
  </body>
</html>